# Установка ноды Aztec с помощью скрипта от pittpv

Данное руководство поможет вам быстро и легко развернуть ноду Aztec с помощью удобного скрипта мониторинга и управления от **pittpv**. Скрипт автоматизирует большую часть рутинных задач, минимизируя риск ошибок.

## Запуск скрипта

Для первоначального запуска скрипта выполните в терминале однострочную команду:

```bash
curl -o aztec-logs.sh https://raw.githubusercontent.com/pittpv/aztec-monitoring-script/main/aztec-logs.sh && chmod +x aztec-logs.sh && ./aztec-logs.sh
```

> **Важно:** Для всех последующих запусков используйте команду:
> ```bash
> cd $HOME && ./aztec-logs.sh
> ```

## Начальная настройка

После запуска скрипт проверит наличие необходимого системного ПО (такого как `docker`, `docker-compose`, `jq` и др.) и предложит его установить. **Согласитесь на установку**, ответив `y` (yes).

В главном меню скрипта вам будет представлен список опций. Для начала установки ноды:

1.  **Выберите пункт `11` основного меню и нажмите Enter.**

    ![Главное меню скрипта](https://raw.githubusercontent.com/pittpv/aztec-monitoring-script/main/other/Aztec-Install-by-Script/1.jpg)

## Проверка портов и установка зависимостей

Скрипт автоматически проверит, заняты ли порты, необходимые для работы ноды (например 40400, 8080). Если порты заняты, он предложит назначить другие, но **рекомендуется использовать стандартные порты**, если это возможно.

Далее будет проверено наличие ПО, специфичного для ноды Aztec, и снова предложена установка. **Согласитесь на установку**.

> **Примечание:** Если на вашем сервере активирован фаерволл `ufw`, скрипт автоматически откроет все необходимые порты.

## Установка бинарных файлов и Docker-образа

На этом этапе скрипт запустит скачивание и установку компонентов ноды с помощью оригинального скрипта от команды Aztec.

**Внимание! Если появится вопрос:**
```
Add it to /root/.bash_profile to make the aztec binaries accessible?
```

**Введите `n` (no).** Только для вопроса, который указан выше. Будьте внимательны.

![Вопрос о добавлении в .bash_profile](https://raw.githubusercontent.com/pittpv/aztec-monitoring-script/main/other/Aztec-Install-by-Script/2.jpg)

## Настройка валидаторов

Следующий вопрос:
```
Do you want to run multiple validators?
```

*   Если вы запускаете **одного валидатора**, введите `n`.
*   Если планируете запускать **несколько валидаторов**, введите `y`.

    ![Выбор количества валидаторов](https://raw.githubusercontent.com/pittpv/aztec-monitoring-script/main/other/Aztec-Install-by-Script/3.jpg)

### Для режима мультивалидатора

Далее необходимо ввести данные валидаторов. Для каждого валидатора введите данные в строгом формате:
`приватный_ключ_с_0x,адрес_валидатора`

Пример:
`0xa1b2c3d4e5f6...,0x742d35Cc6634C0532925a3b844Bc454e4438f44e`

⚠️ Если вы планируете использовать **один адрес** для списывания sepolia eth за транзакции **всех** валидаторов, тогда внесите данные этого адреса первыми. После ввода данных всех валидаторв скрипт уточнит, надо ли использовать первый адрес как publisher-адрес для всех валидаторов (`Use first address as publisher for all validators?`) - выберите **`y`**.

Если же sepolia eth есть на всех адресах, то можно выбрать **`n`** 

![Ввод данных валидатора](https://raw.githubusercontent.com/pittpv/aztec-monitoring-script/main/other/Aztec-Install-by-Script/4.jpg)

### Для режима одного валидатора

Введите по отдельности приватный ключ и eth адрес валидатора.

### Aztec L2 адрес для feeRecipient

После этого скрипт запросит **Aztec L2 адрес**, который вы можете создать на сайте: https://app.obsidion.xyz/ или в расширении https://azguardwallet.io/.

Если по каким-то причинам вы не можете создать Aztec L2 адрес, то вставьте любой приватный ключ, с 0x вначале, от eth кошелька, он по длине такой же, как и Aztec L2 адрес. 

При желании потом сможете заменить на реальный L2 адрес.

![Ввод L2 адреса](https://raw.githubusercontent.com/pittpv/aztec-monitoring-script/main/other/Aztec-Install-by-Script/5.jpg)

> **Важно:** Скрипт автоматически создаст все необходимые конфигурационные файлы (`YML` для web3signer в `/root/aztec/keys` и `keystore.json` в `/root/aztec/config`).

## Конфигурация Docker Compose

Для финальной настройки ноды скрипт запросит у вас данные для генерации файла `docker-compose.yml`:

*   **`ETHEREUM_RPC_URL`** — ваш RPC-адрес для Ethereum L1.
*   **`CONSENSUS_BEACON_URL`** — ваш RPC-адрес для Beacon Chain.
*   **`COINBASE`** — адрес eth кошелька. Введите адрес вашего валидатора.
*   **`P2P_IP`** — этот параметр скрипт определит автоматически. **Если вы используете VPN на сервере**, то после завершения установки ноды необходимо ввести реальный ip-адрес **вручную** в файле `.env` в папке `/root/aztec`

    ![Ввод RPC и других данных](https://raw.githubusercontent.com/pittpv/aztec-monitoring-script/main/other/Aztec-Install-by-Script/6.jpg)

## Установка Watchtower

Скрипт предложит установить **Watchtower** — сервис для автоматического обновления контейнеров вашей ноды. Для настройки уведомлений в Telegram о процессе обновления потребуется:

1.  **Telegram Token:** Получите у [BotFather](https://t.me/BotFather), создав нового бота.
2.  Обязательно **зайдите в своего созданного бота** и отправьте в чат команду `/start`.
3.  **Chat ID:** Узнайте свой ID чата, например, с помощью бота [@myidbot](https://t.me/myidbot).

Введите запрошенные данные при появлении соответствующих запросов.

![Ввод данных для Telegram-уведомлений](https://raw.githubusercontent.com/pittpv/aztec-monitoring-script/main/other/Aztec-Install-by-Script/7.jpg)

## Установка web3signer

Скрипт автоматически скачает образ web3signer и запустит с нужными аргурментами. 

## Завершение установки и проверка

После завершения всех шагов скрипт сообщит об успешной установке и автоматически запустит показ логов (`docker-compose logs -f`).

**Дождитесь появления логов и убедитесь, что нода начала синхронизацию.** Для выхода из режима просмотра логов нажмите сочетание клавиш **`Ctrl+C`**.

На этом установка ноды завершена.

## Дальнейшие действия

1.  **Проверьте статус синхронизации** ноды, выбрав опцию `1` в главном меню скрипта.
2.  **Установите агент мониторинга** для удобного отслеживания работы ноды через опцию `2` в главном меню.
3.  **Проверьте статус валидатора и установите мониторинг позиции в очереди** с помощью опции `9` 

Обязательно изучите другие возможности скрипта в главном меню, такие как:
*   Запуск и остановка контейнеров
*   Даунгрейд версии ноды (на случай проблем с обновлением)
*   Просмотр логов и статистики

Желаем стабильной работы и успеха в запуске ноды!

С уважением,
pittpv

> **Если у вас возникли вопросы по работе скрипта**, задавайте их в нашем Telegram-чате: [https://t.me/+DLsyG6ol3SFjM2Vk](https://t.me/+DLsyG6ol3SFjM2Vk)
